# **PATIENT REPORT VIEWER — CODEX SPEC**

## **Purpose**

The Patient Report Viewer displays a complete, long form HTML report generated by the backend. The frontend does not build or edit the report content. It only renders the HTML, provides navigation, manages scrolling, and handles PDF download. This feature must match the BMC brand style and support easy reading for older users and caregivers.

---

# **1. Route**

```
/reports/:reportId
```

Must be behind authenticated access.

---

# **2. Data Model Returned by Backend**

```json
{
  "id": "uuid",
  "title": "string",
  "generatedAt": "ISO timestamp",
  "sections": [
    {
      "slug": "overview",
      "title": "Overview",
      "html": "<p>HTML content here</p>"
    },
    {
      "slug": "recommendations",
      "title": "Personalized Recommendations",
      "html": "<p>HTML content here</p>"
    },
    {
      "slug": "supplements",
      "title": "Supplements",
      "html": "<p>HTML content here</p>"
    },
    {
      "slug": "test-results",
      "title": "Test Results",
      "html": "<p>HTML content here</p>"
    },
    {
      "slug": "faq-dictionary",
      "title": "FAQs and Dictionary",
      "html": "<p>HTML content here</p>"
    }
  ],
  "pdfUrl": "string"
}
```

All report content is pre formatted HTML.

The frontend must not alter this content.

---

# **3. Page Layout Structure**

The viewer uses a clear, single column reading layout with optional left sidebar for navigation.

### Components:

* ReportHeader
* TableOfContents (TOC) sidebar or mobile accordion
* ReportContent
* PDFDownloadButton

The report must scroll in a continuous long page.

---

# **4. Report Header**

Displays:

* Report title
* Generated date
* Light divider line

No hero image or decorative graphics.

---

# **5. Internal Table of Contents**

### Behavior

* Built from section titles and slugs returned by backend
* Links scroll smoothly to the correct anchor
* Sticky on desktop
* Collapsible accordion on mobile
* Highlights active section on scroll
* Must be keyboard navigable

### Anchor Implementation

Each section must include:

```
<div id="overview">...</div>
```

TOC links:

```
<a href="#overview">Overview</a>
```

Smooth scroll enabled globally:

```css
html {
  scroll-behavior: smooth;
}
```

---

# **6. Section Rendering Rules**

Render sections in the order provided by backend.

Use:

```
dangerouslySetInnerHTML
```

or equivalent safe injection method.

Do not modify medical or educational content.

Spacing:

* 32 px margin above each H2 section
* 16 px space below each paragraph

Maximum content width: 900 to 1100 px for readability.

---

# **7. External Link Handling**

All external research links inside report HTML must open in a new browser tab.

```
<a href="..." target="_blank" rel="noopener noreferrer">
```

Never open external sources in the same tab.

No linking to WordPress medical content.

---

# **8. PDF Export Button**

### Requirements

* Must download the PDF from `pdfUrl`
* Must not trigger browser print
* Must not change content formatting

### Example

```
<a href={report.pdfUrl} download className="btn-primary">
  Download PDF
</a>
```

Can appear at top of page or as floating button on mobile.

---

# **9. Brand Styling Requirements**

Typography:

* H1: 28 to 32 px
* H2: 22 to 24 px
* Body: 16 to 18 px
* Line height: 1.6 to 1.75

Colors:

* BMC teal
* BMC navy
* Neutral grays
* White background

Icons:

* Thin, line based
* Simple and clean

Spacing:

* Large white space
* Calm and readable layout
* No tight clusters of text

Tone:

* Calm
* Supportive
* Clinical
* Non alarming

---

# **10. Mobile Behavior**

* TOC collapses into accordion
* Content becomes single column
* PDF button becomes full width
* Anchors scroll with offset to avoid header overlap

---

# **11. Accessibility Requirements**

* Text contrast WCAG AA
* TOC must support tab navigation
* Focus visible states required
* Touchable areas minimum 44 px
* HTML images must include alt text if provided by backend

---

# **12. Non Negotiable Rules (Richard)**

* Viewer must never split the report into multiple pages
* Viewer must never hide sections behind clicks on desktop
* Viewer must not inject content
* Viewer must not show marketing content
* Viewer must not include fear based language
* No dynamic calculations on client
* No print page functionality
* Only PDF download
* Must display the backend HTML exactly as provided
* Must handle extremely long reports without breaking layout

---

# **13. What the Viewer Must Not Do**

* Do not redesign lab PDFs
* Do not modify the report’s HTML
* Do not perform any trigger logic
* Do not render clinical judgments
* Do not reference WordPress styling or navigation
* Do not embed videos
* Do not collapse sections automatically on desktop
* Do not show progress bars or health scores
* Do not insert emojis

---

# **14. Testing Requirements**

Front end must be able to render:

* Extremely long HTML
* Deep nested lists
* Large tables
* Many external links
* Multiple educational blocks
* Disclaimers
* XpressO sections
* Biomarker educational summaries
* MRI summaries
* Supplements educational content

Using a mock JSON payload.

---

# **15. Summary**

The Report Viewer is a long form, scroll based HTML renderer with a sticky TOC, PDF download button, and BMC branded styling. It must handle complex content safely, cleanly, and calmly. All logic and content come from the backend. The frontend provides layout, navigation, and display only.

---

Ash, this is **the final, polished Codex file**.
You can drop this straight into your repo as is.

When you're ready, we can do:

* the FE scaffolding
* the fake JSON payload
* or move on to Article 2

Just tell me which.